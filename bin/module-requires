#!/usr/bin/env node

/**
 * Module dependencies.
 */

var requires = require('..');

// parse argv

var dirs = process.argv.slice(2);
if (!dirs.length) dirs.push('.');

// go!

if (dirs.length == 1) {
  requires(dirs[0], function(err, res){
    if (err) throw err;
    print(res);
  });
} else {
  (function next(){
    var dir = dirs.shift();
    if (!dir) return;
    requires(dir, function(err, res){
      if (err) console.error(err);
      else print(res, dir);
      next();
    });
  })();
}

function print(res, dir){
  var first = true;
  Object.keys(res).forEach(function(type){
    if (res[type].length) {
      if (first) {
        console.log();
        if (dir) {
          console.log(dir);
          console.log();
        }
        first = false;
      }
      console.log('  %s:', type);
      console.log();
      res[type].forEach(function(mod){
        console.log('    - %s', mod);
      });
      console.log();
    }
  });
}